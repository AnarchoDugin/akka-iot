<!DOCTYPE html>
<html lang="en-US" x-data="DashboardApp()">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="zakuwarrior">
    <link rel="stylesheet" href="../CSS/style.css">
    <title>Device Monitoring Dashboard</title>
    <script defer src="../JS/script.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.8/dist/cdn.min.js"></script>
</head>
<body>
    <div class="container">

        <div x-show="!ApplicationState.isAuthenticated" class="auth-form" x-transition>
            <h2>Authorization</h2>
            <form @submit.prevent="AuthenticateUser">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" class="form-control" x-model="UserCredentials.Username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" class="form-control" x-model="UserCredentials.Password" required>
                </div>
                <div x-show="ErrorMessages.ApplicationError" class="error-message" x-text="ErrorMessages.ApplicationError"></div>
                <button type="submit" class="btn">Log In</button>
            </form>
        </div>

        <div x-show="ApplicationState.isAuthenticated" x-transition>
            <header>
                <div class="logo">
                    <div class="logo-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>
                        </svg>
                    </div>
                    <span>IoT Dashboard</span>
                </div>
                <button class="logout-btn" @click="EndUserSession">Exit</button>
            </header>

            <div class="connection-status">
                <div class="status-indicator" :class="{ 'connected': ApplicationState.isWebSocketConnected }"></div>
                <span x-text="ApplicationState.isWebSocketConnected ? 'Connection established...' : 'Соnnection closed...'"></span>
            </div>

            <div class="devices-grid">
                <template x-for="DeviceItem in DeviceList" :key="DeviceItem.Name">

                    <div class="device-card">
                        <div class="device-header">
                            <h3 class="device-name" x-text="'Device ' + DeviceItem.Name"></h3>
                            <span class="device-status" x-text="'Status: ' + DeviceItem.Status"></span>
                        </div>
                        <div class="device-data">

                            <div class="data-item">
                                <div class="data-label">Temperature</div>
                                <div class="data-value temp-value" x-text="DeviceItem.Temperature + '°C'"></div>
                            </div>

                            <div class="data-item">
                                <div class="data-label">Humidity</div>
                                <div class="data-value humidity-value" x-text="DeviceItem.Humidity + '%'"></div>
                            </div>

                            <div class="data-item">
                                <div class="data-label">Uptime</div>
                                <div class="data-value uptime-value" x-text="DeviceItem.Uptime"></div>
                            </div>
                        </div>
                    </div>

                </template>
            </div>
        </div>
    </div>
</body>
</html>